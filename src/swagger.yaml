openapi: 3.0.0

info:
  title: Clothing Backend API
  version: 1.0.0
  description: Backend APIs for Clothing E-commerce Platform

servers:
  - url: https://clothingbackend-cotb.onrender.com
  - url: http://localhost:5000

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

security:
  - bearerAuth: []

paths:
  /health:
    get:
      summary: Health check
      security: []
      responses:
        "200":
          description: Server is running

  # ---------- AUTH ----------
  /api/auth/register:
    post:
      summary: Register new user
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, email, password]
              properties:
                name:
                  type: string
                  example: Devansh
                email:
                  type: string
                  example: dev@gmail.com
                password:
                  type: string
                  example: 123456
      responses:
        "201":
          description: User registered

  /api/auth/login:
    post:
      summary: Login user
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  example: dev@gmail.com
                password:
                  type: string
                  example: 123456
      responses:
        "200":
          description: JWT token returned

  /api/auth/logout:
    post:
      summary: Logout user
      responses:
        "200":
          description: Logged out successfully

  # ---------- CATEGORIES ----------
  /api/categories:
    get:
      summary: Get all categories
      security: []
      responses:
        "200":
          description: List of categories

    post:
      summary: Create category (Admin)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name:
                  type: string
                  example: T-Shirts
      responses:
        "201":
          description: Category created

  # ---------- PRODUCTS ----------
  /api/products:
    get:
      summary: Get products with filters
      security: []
      parameters:
        - in: query
          name: q
          schema: { type: string }
          example: oversized
        - in: query
          name: page
          schema: { type: integer }
          example: 1
        - in: query
          name: limit
          schema: { type: integer }
          example: 12
      responses:
        "200":
          description: Product list

    post:
      summary: Create product (Admin)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, slug, price, stock]
              properties:
                title:
                  type: string
                slug:
                  type: string
                price:
                  type: number
                stock:
                  type: integer
      responses:
        "201":
          description: Product created

  /api/products/{slug}:
    get:
      summary: Get product by slug
      security: []
      parameters:
        - in: path
          name: slug
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Product details

  # ---------- CART ----------
  /api/cart:
    get:
      summary: Get my cart
      responses:
        "200":
          description: Cart details

    post:
      summary: Add item to cart
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "201":
          description: Item added

    put:
      summary: Update cart item quantity
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          description: Cart updated

    # ---------- WISHLIST ----------

  /api/wishlist:
    get:
      summary: Get my wishlist
      responses:
        "200":
          description: Wishlist items

    post:
      summary: Add product to wishlist
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [productId]
              properties:
                productId:
                  type: string
      responses:
        "200":
          description: Added

  /api/wishlist/{productId}:
    delete:
      summary: Remove product from wishlist
      parameters:
        - in: path
          name: productId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Removed

    # ---------- USER PROFILE ----------
  /api/users/me:
    get:
      summary: Get my profile
      description: Returns logged-in user profile
      responses:
        "200":
          description: User profile fetched
          content:
            application/json:
              example:
                id: "697321f330ddd14a9cffb974"
                name: "Devansh Mishra"
                email: "dev@gmail.com"
                phone: "9999999999"
                avatar: "https://image-url.com/avatar.jpg"

    put:
      summary: Update my profile
      description: Update logged-in user's profile details
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: Devansh Mishra
                phone:
                  type: string
                  example: "9999999999"
                avatar:
                  type: string
                  example: https://image-url.com/avatar.jpg
      responses:
        "200":
          description: Profile updated
          content:
            application/json:
              example:
                message: Profile updated
                user:
                  id: "697321f330ddd14a9cffb974"
                  name: Devansh Mishra
                  email: dev@gmail.com
                  phone: "9999999999"
                  avatar: https://image-url.com/avatar.jpg

  # ---------- ADDRESS ----------
  /api/addresses:
    get:
      summary: Get my addresses
      responses:
        "200":
          description: Address list

    post:
      summary: Add new address
      description: Save a delivery address for logged-in user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                [fullName, phone, line1, city, state, pincode]
              properties:
                fullName:
                  type: string
                  example: Devansh Mishra
                phone:
                  type: string
                  example: "9999999999"
                line1:
                  type: string
                  example: Street 1, Near Metro
                line2:
                  type: string
                  example: Apartment 201
                city:
                  type: string
                  example: Lucknow
                state:
                  type: string
                  example: Uttar Pradesh
                pincode:
                  type: string
                  example: "226001"
                country:
                  type: string
                  example: India
                isDefault:
                  type: boolean
                  example: true

  /api/addresses/{id}:
    put:
      summary: Update address
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Address updated

    delete:
      summary: Delete address
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Address deleted

  # ---------- ORDERS ----------
  /api/orders/cod/from-cart:
    post:
      summary: Place COD order
      responses:
        "201":
          description: Order created

  /api/orders/me:
    get:
      summary: Get my orders
      responses:
        "200":
          description: Orders list

  /api/orders/{id}/status:
    put:
      summary: Admin update order status
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
                  enum:
                    - pending
                    - confirmed
                    - shipped
                    - delivered
                    - cancelled
      responses:
        "200":
          description: Order updated

  # ---------- PAYMENTS ----------
  /api/payment/create-order:
    post:
      summary: Create Razorpay payment order
      description: Creates payment order for an existing backend order
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [orderId]
              properties:
                orderId:
                  type: string
                  example: 6971cd4cbaefbdd724feae90
      responses:
        "200":
          description: Payment order created

  /api/payment/verify:
    post:
      summary: Verify payment after checkout
      description: Verifies Razorpay payment and updates order
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                [razorpay_order_id, razorpay_payment_id, razorpay_signature, orderId]
              properties:
                razorpay_order_id:
                  type: string
                  example: order_xxxxx
                razorpay_payment_id:
                  type: string
                  example: pay_xxxxx
                razorpay_signature:
                  type: string
                  example: signature_here
                orderId:
                  type: string
                  example: 6971cd4cbaefbdd724feae90
      responses:
        "200":
          description: Payment verified successfully


  # ---------- CANCEL ORDER ----------

  /api/orders/{id}/cancel:
    put:
      summary: Cancel my order
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Order cancelled

  # ---------- REVIEWS ----------

  /api/products/{id}/review:
    post:
      summary: Add or update product review
      description: Logged-in user can add or update review for a product
      parameters:
        - in: path
          name: id
          required: true
          schema:
          type: string

      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [rating]
              properties:
                rating:
                  type: number
                  example: 5
                comment:
                  type: string
                  example: Great quality product!
            example:
              rating: 5
              comment: Great quality product!

      responses:
        "200":
          description: Review saved successfully

  /api/products/{id}/reviews:
    get:
      summary: Get product reviews
      description: Returns all reviews for a product
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string

      responses:
        "200":
          description: Reviews list returned

  # ---------- UPLOAD ----------
  /api/upload:
    post:
      summary: Upload single image
      responses:
        "201":
          description: Uploaded

  /api/upload/multiple:
    post:
      summary: Upload multiple images
      responses:
        "201":
          description: Uploaded

  # ---------- ADMIN ----------
  /api/admin/users:
    get:
      summary: List all users
      responses:
        "200":
          description: Users list

  /api/admin/dashboard:
    get:
      summary: Admin dashboard statistics
      responses:
        "200":
          description: Dashboard stats returned
